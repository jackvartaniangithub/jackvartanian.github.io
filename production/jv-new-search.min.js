(function () {

    try {

        let NewSearch = {
            init: () => {
                // Funções que estavam inline
                NewSearch.applyCollections();
                NewSearch.applyShowContentBtn();
                NewSearch.applyFilters();

                // arrangeFiltersDeskMobileFunctions
                NewSearch.hideActiveFilter();
                NewSearch.arrangeOrderBy();
                NewSearch.startMobile();

                // filterBoxFunctions
                NewSearch.start();
                NewSearch.appendMostraFiltros();
                NewSearch.appendRemoveBtnTodosFiltros();
                NewSearch.removeMarcaPaisFromVinhos();
                NewSearch.showBox();
                NewSearch.initOrderBox();

                // shelfAdegaFunctions
                NewSearch.startFlags();
                NewSearch.createObservers();
                NewSearch.mobileChanges();
                NewSearch.starterKitFunctions();
                NewSearch.unityFirst();

                // generalFunctions
                NewSearch.arrangePagination();
                NewSearch.arrangeOrderByScore();
                NewSearch.arrangeSlick();
                NewSearch.scriptPopUpAdega();

                // other
                NewSearch.otherFunctions();
                NewSearch.applyPromotionWeekCustomer();
            },
            windowOnload: () => {
                NewSearch.applyRemoveCatAzeite();
            },
            ajaxStop: () => { },
            collectionData: () => {
                return [
                    {
                        'name': 'Black%20Leopardo',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/black-leopardo.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalaogo_black-leopardo.jpg',
                        'videoUrl': 'ZLsR4uFrHa4',
                    },
                    {
                        'name': 'Leopardo',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/leopardo.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_leopardo.jpg',
                        'videoUrl': 'psw_U0j7qi8',
                    },
                    {
                        'name': 'Rock%20Star',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/rock-star.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_rock-star.jpg',
                        'videoUrl': 'vvOPbTmxwoc',
                    },
                    {
                        'name': 'Rock%20Chain',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/rock-chain.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_rock-chain.png',
                        'videoUrl': 'lzIQkQWo02M',
                    },
                    {
                        'name': 'Chain',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/chain.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner-catalogo-chain-338x150.jpg',
                        'videoUrl': 'qbqegU4Y5Gg',
                    },
                    {
                        'name': 'POP!',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/pop.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_pop.jpg',
                        'videoUrl': 'oW7CmmVzOsg',
                    },
                    {
                        'name': 'Pop%20Chain',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/pop-chain.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_pop-chain.jpg',
                    },
                    {
                        'name': 'LIFE@dot@STYLE',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/lifestyle.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_lifestyle.jpg',
                        'videoUrl': 'X5XcFP_wLJc',
                    },
                    {
                        'name': 'Avant%20Garde',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/avant-garde.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_avant-garde.jpg',
                    },
                    {
                        'name': 'White%20Chain',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/white-chain.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_white-chain.jpg',
                        'videoUrl': 'MWSl3o64nEo',
                    },
                    {
                        'name': '15%20anos',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/15anos_novo_08_2021.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_15-anos.jpg',
                    },
                    {
                        'name': 'First%20Diamond',
                        'videoUrl': 'sKEVbFXuOP4',
                    },
                    {
                        'name': 'Amore',
                        'videoUrl': 'U68s3JMpiJ0',
                    },
                    {
                        'name': 'Choker',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/choker.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_choker.jpg',
                        'videoUrl': '4tA1V09EzuU',
                    },
                    {
                        'name': 'Rock%20@-@%20Hot',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/rock-hot.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_rock-hot.jpg',
                        'videoUrl': 'X7INWrhu16Q',
                    },
                    {
                        'name': 'Riviera',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/riviera.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_riviera.jpg',
                        'videoUrl': 'BtqqybGVpjw',
                    },
                    {
                        'name': 'Voyeur',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/voyeur.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_voyeur.jpg',
                        'videoUrl': 'e1sku-BL_Yc',
                    },
                    {
                        'name': 'Love%20NY',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/love-ny.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_love-ny.jpg',
                        'videoUrl': 'e1sku-BL_Yc',
                    },
                    {
                        'name': 'Orqu%C3%ADdea',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/orquidea.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_orquidea.png',
                        'videoUrl': 'RbGs9H4ggC0',
                    },
                    {
                        'name': 'JV%20MAN%20II',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/jv-man-ii.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_jv-man-ii.jpg',
                        'videoUrl': 'IdqBFkb-rwM',
                    },
                    {
                        'name': 'JV%20MAN',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/jv-man.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_jv-man.jpg',
                        'videoUrl': 'PNVwOM8GQRA',
                    },
                    {
                        'name': 'Pequeno%20Pr%C3%ADncipe',
                        'videoUrl': 'GQbhKbxL12o',
                    },
                    {
                        'name': 'Blossom',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/blossom.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_blossom.jpg',
                    },
                    {
                        'name': 'Deco',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/deco.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_deco.jpg',
                    },
                    {
                        'name': 'Piscine',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/piscine.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_piscine.jpg',
                    },
                    {
                        'name': 'Universo',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/universo.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_universo.jpg',
                    },
                    {
                        'name': 'We%20Love%20Sapphire',
                        'pdfUrl': 'https://site-jv-br.s3.sa-east-1.amazonaws.com/pdf-colecoes/we-love-sapphire.pdf',
                        'pdfImageUrl': 'https://jackvartanian.vteximg.com.br/arquivos/banner_catalogo_we-love-sapphire.jpg',
                    },
                ]
            },
            applyCollections: () => {
                let collectionData = NewSearch.collectionData();
                // const colNameFromUrl = document.URL.split('.com/joias/')[1].split('?')[0];
                if (!document.URL.match('.com/joias/')) {
                    console.info("stoping [applyCollections].\n");
                    return;
                }
                const colNameFromUrl = document.URL.split('.com/joias')[1].split('?')[0];
                const colData = collectionData.find(col => col.name.toLocaleLowerCase() === colNameFromUrl.toLocaleLowerCase());
                if (colData) {
                    const pdfUrl = colData.pdfUrl;
                    const pdfImageUrl = colData.pdfImageUrl;
                    const videoUrl = colData.videoUrl;

                    const videoDiv = videoUrl ?
                        `<div class='collection-video'> 
                            <iframe src="https://www.youtube.com/embed/${videoUrl}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            <p>Assista ao fashion film</p>
                        </div>` : '';

                    const pdfDiv = pdfUrl && pdfImageUrl ?
                        `<div class='collection-pdf'>
                            <a href="${pdfUrl}" target="_blank">
                                <img src="${pdfImageUrl}" alt="">
                                <p>Veja a campanha</p>
                            </a>
                        </div>` : '';

                    var ht = `
                    <div class='collection-info-banner'>
                        ${videoDiv}
                        ${pdfDiv}
                    </div>
                    `;

                    let el = document.createElement('div')
                    el.innerHTML = ht;
                    document.querySelector('div.main').insertAdjacentElement('beforebegin', el);

                }
            },
            applyShowContentBtn: () => {
                if (!$(".show-content-btn").length) {
                    console.info("stoping [applyShowContentBtn].\n");
                    return;
                }
                var contentHidden = document.getElementsByClassName("show-content-btn");
                var i;
                for (i = 0; i < contentHidden.length; i++) {
                    contentHidden[i].addEventListener("click", function () {
                        this.classList.toggle("active");
                        var content = this.nextElementSibling;
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                        } else {
                            content.style.maxHeight = content.scrollHeight + "px";
                        }
                    });
                }
            },
            applyFilters: () => {
                // if ($('.filtro-ativo')[0] != undefined) {
                if (!$('.filtro-ativo').length) {
                    console.info("stoping [applyFilters].\n");
                    return;
                }

                if (document.URL.includes('/joias/Amor')) {
                    if ($('ul .filtro-ativo')[0].innerText == 'Amor e Noivado') {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal"><div class="textoWelcome"><h1 class="headline-category">AMOR E NOIVADO</h1><h2 class="hello-citizen">Joias de noivado para fazer seus sonhos se realizarem, porque toda noiva merece uma joia deslumbrante.</h2></div></div>');
                    }
                }
        
                if (document.URL.includes('/aneis')) {
                    if ($('ul .filtro-ativo')[0].innerText == 'Solitário Amor e Noivado') {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal rings"><div class="textoWelcome"><h1 class="headline-category">ANÉIS SOLITÁRIOS</h1><h2 class="hello-citizen">Anéis de noivado para fazer seus sonhos se realizarem, porque toda noiva merece um anel solitário deslumbrante.</h2></div></div>');
                    }
                    else if ($('ul .filtro-ativo')[0].innerText == 'Aliança') {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal rings"><div class="textoWelcome"><h1 class="headline-category">ALIANÇAS</h1><h2 class="hello-citizen">Temos uma aliança de casamento para cada estilo de noivos! Escolha a sua aliança de ouro para marcar esse momento especial..</h2></div></div>');
                    }
                }
        
                if (document.URL.includes('/brincos')) {
                    if ($('ul .filtro-ativo')[0].innerText == 'Cometa') {
                        $('h1.headline-category').html('Brincos Cometa');
                    }
                    if ($('ul .filtro-ativo')[0].innerText == 'Solitário Amor e Noivado') {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal earrings"><div class="textoWelcome"><h1 class="headline-category">BRINCOS SOLITÁRIOS</h1><h2 class="hello-citizen">Brincos solitários lindos e minimalistas para impressionar mais ainda no seu casamento</h2></div></div>');
                    }
                    if ($('ul .filtro-ativo')[0].innerText.includes('Amor e noivado')) {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal earrings"><div class="textoWelcome"><h1 class="headline-category">BRINCOS DE AMOR E NOIVADO</h1><h2 class="hello-citizen">Brincos solitários lindos e minimalistas para impressionar mais ainda no seu casamento.</h2></div></div>');
        
                    }
                }
        
                if (document.URL.includes('/colares')) {
                    if ($('ul .filtro-ativo')[0].innerText == 'Solitário Amor e Noivado') {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal necklaces"><div class="textoWelcome"><h1 class="headline-category">COLARES SOLITÁRIOS</h1><h2 class="hello-citizen">Garanta seu colar para usar no grande dia! Solitários para fazer a noiva brilhar ainda mais!</h2></div></div>');
                    } else if ($('ul .filtro-ativo')[0].innerText.includes('Amor e noivado')) {
                        $('h1.headline-category').html('<div class="amoreBannerPrincipal necklaces"><div class="textoWelcome"><h1 class="headline-category">COLARES DE AMOR E NOIVADO</h1><h2 class="hello-citizen">Garanta seu colar para usar no grande dia! Solitários para fazer a noiva brilhar ainda mais!</h2></div></div>');
                    }
                }
        
                if (document.URL.includes('/pulseiras')) {
                    if ($('ul .filtro-ativo')[0].innerText == 'Solitário Amor e Noivado') {
                        $('h1.headline-category').html('Brincos Solitários');
                        $('h1.headline-category').after('<div class="short-long-category">Brincos solitários lindos e minimalistas para impressionar mais ainda no seu casamento</div>');
                    }
                    if ($('ul .filtro-ativo')[0].innerText.includes('Amor e noivado')) {
                        $('h1.headline-category').html('Pulseiras de Amor e Noivado');
                        $('h1.headline-category').after('<div class="short-long-category">Pulseiras lindas e minimalistas para impressionar mais ainda no seu casamento</div>');
                    }
                }
            },
            applyRemoveCatAzeite: () => {
                if (document.URL.includes('/adega')) {
                    let newItem = document.createElement('li');
                    newItem.innerHTML = '<a href="/adega/clube-do-vinho" style="display: inline-block; font-size: 12.5px; text-transform: uppercase; font-weight: 400; letter-spacing: 3px; color: #6f6f6f; line-height: 50px; list-style: none">Clube do Vinho</a>';
                    azeites = document.getElementsByClassName('HideAzeites')[0]
                    azeites.parentNode.replaceChild(newItem, azeites);
                }
            },
            // arrangeFiltersDeskMobileFunctions
            startMobile: () => {
                if ($("body").width() < 1024 || $(window).width() < 1024) {
                    $(".categoria .search-single-navigator").hide();
                    $('div.header-search').before("<div class='menu-dep-filtrar'>FILTRAR POR</div>");
        
                    $(".categoria .menu-departamento h5").click(function(t) {
                        //t.stopPropagation(), 
                        t.preventDefault(), $(this).toggleClass("active");
                    });
        
                    $(".menu-dep-filtrar").click(function(t) {
                        $('.menu-dep-filtrar').toggleClass("active");
                        $(".categoria .search-single-navigator").slideToggle();
                    });
                }
            },
            hideActiveFilter: () => {
                $(".categoria .search-single-navigator h5").each(function() {
                    ultimoDoArray = $(this)[0].classList.length - 1;
                    classeWrap = $(this)[0].classList[ultimoDoArray]
                    hide = classeWrap.substr(0, 4);
        
                    if (hide == 'Hide') {
                        $(this).add($(this).next("ul")).wrapAll('<div class="wrapFilterItem ' + classeWrap + '"/>')
                    } else {
                        $(this).add($(this).next("ul")).wrapAll('<div class="wrapFilterItem desativaColecao ' + classeWrap + '"/>')
                    }
                })
            },
            arrangeOrderBy: () => {
                //orderby rearrange
                try {
                    $('.orderby-container').append($('.main .sub')[0]);
                    $('.orderBy label').wrap('<div></div>');
                    $('.orderBy select').wrap('<div></div>');
                    $('.sub:first').show()

                    if ($('.orderBy div label')[0].innerText == 'ORDENAR POR:') {
                        $('.orderBy div label')[0].innerText = 'ORDENAR:';
                    }

                    $('.voltar-orderby').css('height', '38px');

                    if (document.URL.includes('/adega')) {
                        var sWines = '<div class="wrapFilterItem HideVinho"><h5 class="Hide even Especificações vinhos HideVinho">Vinhos</h5><ul class="Vinho  even Especificações vinhos">' +
                            '<li><a href="https://br.jackvartanian.com/adega/vinhos/Tinto?O=OrderByScoreDESC&amp;PS=18&amp;map=c,c,specificationFilter_42" title="Tinto">Tinto (35)</a></li>' +
                            '<li><a href="https://br.jackvartanian.com/adega/vinhos/Branco?O=OrderByScoreDESC&amp;PS=18&amp;map=c,c,specificationFilter_42" title="Branco">Branco (13)</a></li>' +
                            '<li><a href="https://br.jackvartanian.com/adega/vinhos/Espumante?O=OrderByScoreDESC&amp;PS=18&amp;map=c,c,specificationFilter_42" title="Espumante">Espumante (6)</a></li>' +
                            '<li class="last"><a href="https://br.jackvartanian.com/adega/vinhos/Rose?O=OrderByScoreDESC&amp;PS=18&amp;map=c,c,specificationFilter_42" title="RosÃ©">RosÃ© (1)</a></li>' +
                            '</ul></div>'
                        var sOil = '<p><a href="/adega?fq=C:1000029/1000030/&fq=H:415" style="display: inline-block; font-size: 12.5px; text-transform: uppercase; font-weight: 400; letter-spacing: 3px; color: #6f6f6f; line-height: 50px; list-style: none !important;">Clube do Vinho</a></p>';
                        var sDest = '<div class="wrapFilterItem HideDestilados"><h5 class="Hide even HideFaixa-de-preco">Destilados</h5><ul class="Faixa de preço  even"><li><a href="https://br.jackvartanian.com/adega/destilados/cachaca?O=OrderByScoreDESC" title="">CachaÃ§a</a></li></ul></div>'

                        if (vtxctx.categoryName == 'Adega') {
                            if (document.URL.includes('/adega?fq=C:1000029/1000030/&fq=H:415')) {
                                var azeiteDestiladoFilters = sWines + sDest;
                            } else {
                                var azeiteDestiladoFilters = sWines + sOil + sDest;
                            }
                        } else if (vtxctx.categoryName == 'Vinhos') {
                            var azeiteDestiladoFilters = sOil + sDest;
                        } else if (vtxctx.categoryName == 'Azeites') {
                            var azeiteDestiladoFilters = sWines + sDest;
                        } else if (vtxctx.categoryName == 'Destilados') {
                            var azeiteDestiladoFilters = sWines + sOil;
                        }

                        $('.categoria .search-single-navigator').append(azeiteDestiladoFilters);
                    }

                    if ($(window).width() > 769) {
                        $('.categoria .search-single-navigator').append($('.voltar-orderby'))
                        if (vtxctx.categoryName == 'Adega' || vtxctx.categoryName == 'Vinhos') {
                            var weekSelection = '<p><a href="/adega/vinhos-da-semana?fq=C:1000029,H:414" style="display: inline-block; font-size: 12.5px; text-transform: uppercase; font-weight: 800; letter-spacing: 3px; color: #000000; line-height: 50px; list-style: none !important;">SeleÃ§Ã£o da Semana</a></p>';
                            $('.categoria .search-single-navigator').append(weekSelection);
                        }
                    }
                } catch (e) {
                    console.log("Error in [arrangeOrderBy]");
                    console.log(e.message);
                }
            },
            // filterBoxFunctions
            start: () => {
                listaFiltros = $('.navigation-tabs').append("<section class='n1__filtros__box'><div class='boxFiltros'></div><div class='boxRemove'></div></section>");
                boxFiltros = $('.n1__filtros__box .boxFiltros');
                boxRemove = $('.n1__filtros__box .boxRemove');
                // INICIO TEST SCRIPT //
                if (document.URL.includes('adega/vinhos/Sele')) {
                    document.getElementsByClassName('n1__filtros__box')[0].style.display = 'none';
                }
            },
            appendMostraFiltros: () => {
                filtrado = $('.filtro-ativo');
                for (i = 0; i < filtrado.length; i++) {
                    linkFiltrado = filtrado.eq(i).next()[0].href;
                    txtFiltrado = filtrado[i].innerText;
                    tipoFiltro = filtrado.parent().parent()[i].classList[2];
                    try {
                        nomeFiltro = $("h5." + tipoFiltro)[0].innerText + ":";
                    } catch (error) {
                        nomeFiltro = ""
                        console.log("Error in [appendMostraFiltros]");
                        console.log(error.message);
                    }
                    caixaFiltro = "<a class='caixa-todosFiltros' href='" + linkFiltrado + "'><span class='tipoFiltro'>" + nomeFiltro + "</span>" + "<span class='txtFiltrado'> " + txtFiltrado + "</span></a>";
        
                    boxFiltros.append(caixaFiltro);
                }
            },
            appendRemoveBtnTodosFiltros: () => {
                joias = window.location.href.split("/");
                nextJoias = joias.length - $('.caixa-todosFiltros').length - 1;
                order = '?O=OrderByScoreDESC';
                link = "/" + joias[3] + "/" + joias[nextJoias] + "/" + order;
                if (link.split('/')[2] == 'joias') {
                    link = "/" + joias[3] + order
                }
                removerFiltro = "<a class='remove-todosFiltros' href='" + link + "'>Remover filtros</a>";
                try {
                    if (!$('.tipoFiltro').length) {
                        return;
                    }
                    if ($('.tipoFiltro').text() == '') {
                        $('.caixa-todosFiltros:first-of-type').hide()
                        if ($('.filtro-ativo').length == 1) {
                            $('.n1__filtros__box').hide();
                        }
                        link = "/" + joias[3] + "/" + joias[4] + "?O=OrderByScoreDESC&PS=18&map=c,productClusterSearchableIds"
                        removerFiltro = "<a class='remove-todosFiltros' href='" + link + "'>Remover filtros</a>";
                    }
                    // if ($('.tipoFiltro')[0].innerHTML == '') {}
                } catch (error) {
                    console.log('Error in [appendRemoveBtnTodosFiltros]');
                    console.log(error.message);
                }
                boxRemove.append(removerFiltro);
            },
            removeMarcaPaisFromVinhos: () => {
                if (vtxctx["categoryId"] == "1000030") {
                    $('.wrapFilterItem.HidePais').hide();
                    $('.wrapFilterItem.HideMarca').hide();
                }
            },
            showBox: () => {
                if ($('.n1__filtros__box div a').hasClass('caixa-todosFiltros') == false) {
                    $('.n1__filtros__box').addClass('unshow-Filtros')
                } else {
                    $('.n1__filtros__box').removeClass('unshow-Filtros')
                }
            },
            initOrderBox: () => {
                $(".voltar-orderby .orderby-container .sub .orderBy select#O option:first-child").text('Ordenar')
                /* Look for any elements with the class "custom-select": */
                var containerSlc = $(".voltar-orderby .orderby-container .sub .orderBy div+div")
                selElmnt = containerSlc[0].getElementsByTagName("select")[0];
        
        
                var slcDiv = document.createElement("DIV");
                slcDiv.setAttribute("class", "select-selected");
                slcDiv.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
                containerSlc[0].appendChild(slcDiv);
        
        
                /* For each element, create a new DIV that will contain the option list: */
                var slcHideDiv = document.createElement("DIV");
                slcHideDiv.setAttribute("class", "select-items");
                for (j = 1; j < selElmnt.length; j++) {
                    /* For each option in the original select element,
                    create a new DIV that will act as an option item: */
                    var optDiv = document.createElement("DIV");
                    // var optA = document.createElement("A");
        
                    // optDiv.appendChild(optA)
        
                    optDiv.innerHTML = selElmnt.options[j].innerHTML;
                    optDiv.dataset["value"] = selElmnt.options[j].value;
                    optDiv.addEventListener("click", function(e) {
                        /* When an item is clicked, update the original select box,
                        and the selected item: */
                        fakeSelect = this.parentNode.parentNode.getElementsByTagName("select")[0];
                        fakeSelected = this.parentNode.previousSibling;
                        for (i = 0; i < fakeSelect.length; i++) {
        
                            if (fakeSelect.options[i].innerHTML == this.innerHTML) {
                                fakeSelect.selectedIndex = i;
                                fakeSelected.innerHTML = this.innerHTML;
                                fakeChangeSelected = this.parentNode.getElementsByClassName("same-as-selected");
                                for (k = 0; k < fakeSelected.length; k++) {
                                    fakeChangeSelected[k].removeAttribute("class");
                                }
                                this.setAttribute("class", "same-as-selected");
        
                                break;
                            }
        
                        }
                        fakeSelected.click();
                        var windowCurrentRef = String($('.orderby-container select#O')[0].onchange).split('\n')[1].split("= ")[1].split(" + ")[0].split("'")[1]
                        window.location.href = windowCurrentRef + 'O=' + this.dataset["value"]
                    })
                    slcHideDiv.appendChild(optDiv);
        
                }
        
                containerSlc[0].appendChild(slcHideDiv);
        
                if ($(document).width() <= 768) {
                    var weekSelection = '<p><a href="/adega?fq=C:1000029&fq=H:414" style="display: inline-block; font-size: 12.5px; text-transform: uppercase; font-weight: 400; letter-spacing: 3px; color: #6f6f6f; line-height: 50px; list-style: none !important;">Selecao da Semana</a></p>'
                    $(".search-single-navigator").append($(".voltar-orderby"))
                    $('.categoria .search-single-navigator').append(weekSelection)
        
        
                    //REMOVE FILTROS APARECE APENAS QUANDO OS FILTROS ESTÃƒÆ’Ã†â€™O ABERTOS
                    $('.menu-dep-filtrar').click(() => {
                        if ($('.menu-dep-filtrar').hasClass('active')) {
                            $('.boxRemove').show()
                        } else {
                            $('.boxRemove').hide()
                        }
                    })
        
                    $('.select-selected').click(() => {
                        $('.select-selected').toggleClass('active')
                    })
                }
            },
            // shelfAdegaFunctions
            fixPrice: (price) => {
                var np = '';
                p = price.toFixed(2).replace('.', ',');
                if (p.split(',')[0].length == 4) {
                    np = 'R$ ' + p[0] + '.' + p.substring(1, p.length);
                } else if (p.split(',')[0].length == 5) {
                    np = 'R$ ' + p.substring(0, 2) + '.' + p.substring(2, p.length)
                } else {
                    np = 'R$ ' + p;
                }
                return np;
            },
            insertFlag: (flag, i) => {
                try {
                    discount = .95
                    if (flag.eq(i).find('.shelfdepartment')[0].innerText == 'Adega') {
        
                        if (flag.eq(i).find('.shelfcategory')[0].innerText == 'Azeites') {
                            var price = flag.eq(i).find('.price .newPrice');
                            var price2 = parseFloat(price[0].innerText.replace('R$ ', '').replace('.', '').replace(',', '.'));
                            price.after('<span>unidade</span>')
                            flag.eq(i).find('p.price').before('<p class="price"><span class="priceCaixa">' + shelfAdegaFunctions.fixPrice(price2 * discount) +
                                '</span> <span>na caixa de 12 un.</span></p>');
                        } else {
                            var price = flag.eq(i).find('.price .newPrice');
                            var price2 = parseFloat(price[0].innerText.replace('R$ ', '').replace('.', '').replace(',', '.'));
                            price.after('<span>unidade</span>')
                            flag.eq(i).find('p.price').before('<p class="price"><span class="priceCaixa">' + shelfAdegaFunctions.fixPrice(price2 * discount) +
                                '</span> <span>a un. na caixa com 6</span></p>');
        
                        }
        
                    }
                } catch (error) {
                    console.log('error insertFlag function')
                    console.log(error.message);
                }
            },
            startFlags: () => {
                var flagEl = $('.prateleira .data');
                for (i = 0; i < flagEl.length; i++) {
                    NewSearch.insertFlag(flagEl, i);
                }
            },
            createObservers: () => {
                var observerDon = new MutationObserver(function(mutations) {
                    if (mutations) {
                        flagElDon = $('.prateleira .data');
                        for (i = 0; i < flagElDon.length; i++) {
                            shelfAdegaFunctions.insertFlag(flagElDon, i);
        
                        }
                    }
                })
        
                var mutatedShelf3 = document.querySelector('.prateleira[id*=ResultItems]');
                try {
                    observerDon.observe(mutatedShelf3, { childList: true })
                } catch (e) {
                    console.log('error donation shelf');
                    console.log(e.message);
                }
            },
            mobileChanges: () => {
                if ($(document).width() <= 1024) {
                    var opt = $('.selectUn-Cx option')
                    for (i = 0; i < opt.length; i++) {
                        if (i % 2 == 0) { opt[i].innerText = 'Cx.' } else {
                            opt[i].innerText = 'Un.'
        
                        }
                    }
                }
            },
            unityFirst: () => {
                var opt = $('.selectUn-Cx option')
                for (i = 0; i < opt.length; i++) {
                    if (i % 2 != 0) {
                        opt[i].selected = true
                    }
                }
            },
            starterKitFunctions: () => {
                //starterKit compra inicial UNIDADE
                janela = window.location.href.includes('starter-kit')
                if (janela) {
                    var opt = $('.selectUn-Cx option')
                    for (i = 0; i < opt.length; i++) {
                        if (i % 2 != 0) {
                            opt[i].selected = true
                        }

                    }

                }


                //banner starter kit pagina Vinhos 
                banners = window.location.href.includes("banners=true")
                if (banners) {
                    $('.starterkit-banners').show();
                    $('.breadcrumbJV').hide();
                }
            },
            // generalFunctions
            arrangePagination: () => {

                $(document).on('click', '.pages li', function() {
                    $('html, body').animate({ scrollTop: $('.prateleira.vitrine').offset().top - 200 }, 1000);
                });
        
                window.addEventListener('hashchange', function() {
                    setTimeout(function() {
                        curPg = $('.pgCurrent')[0].innerText;
                        hash = window.location.hash;
                        if (hash == '') {
                            hashNum = 1;
                        } else {
                            hashNum = window.location.hash.replace('#', '');
                        }

                        if (curPg != hashNum) {
                            //$('.main').hide();
                            //$('.n1-footer').before('<p class="pag-loading" style="text-align:center">Carregando...</p>');
        
                            pgsDynamicId = $('[id^=PagerBottom]')[0].id.split('_')[1];
        
                            //modify pageclick function
                            originalF = eval('PageClick_' + pgsDynamicId).toString();
                            modifiedF = originalF.replace('window.location.hash = pageclickednumber;', '');
                            eval('PageClick_' + pgsDynamicId + '=' + modifiedF);
        
                            //run modified pageclick function
                            eval('PageClick_' + pgsDynamicId + '(' + hashNum + ')')
        
                            //return pageclick function to original form
                            eval('PageClick_' + pgsDynamicId + '=' + originalF);
        
                            //$('.main').show();
                            //$('.pag-loading').remove();
        
                        }
                    }, 1500);
        
                });
        
            },
            arrangeOrderByScore: () => {
        
                $.each($('.search-single-navigator a'), function(index, val) {
                    val.href = val.href.replace('vtexscore+desc', 'OrderByScoreDESC');
        
                });
        
                $('.orderBy select').append('<option value="OrderByScoreDESC">RelevÃƒÆ’Ã‚Â¢ncia</option>');
                if (document.URL.includes('ScoreDESC')) {
                    $('.orderBy option[value=OrderByScoreDESC]').attr('selected', 'selected')
                }
            },
            arrangeSlick: () => {
                const slickSettings = {
                    slidesToShow: 4,
                    slidesToScroll: 1,
                    variableWidth: false,
                    arrows: true,
                    prevArrow: '<span class="slick-arrow slick-prev"></span>',
                    nextArrow: '<span class="slick-arrow slick-next"></span>',
                    responsive: [
        
                        {
                            breakpoint: 768,
                            settings: {
                                slidesToShow: 2,
                                slidesToScroll: 1,
                            }
                        }
                    ]
                }
        
                $('.placements-vitrines-imgs .vitrine').slick(slickSettings);
            },
            scriptPopUpAdega: () => {
                $('.hello-jvWorld ').html('Bem-vindo ÃƒÆ’  Jack Vartanian Adega!');
                $('.pop-email-a').href = 'mailto:adega@jackvartanian.com';
                $('.popup-email').html('<div class="popup-email"><p>Email</p><span>Entre em contato conosco pelo </span><span>nosso e-mail: adega@jackvartanian.com</span></div>');
                $('.popup-lojas').hide();
            },
            // structuresFunctions
            retira_acentos: (str) => {
                com_acento = "ÃƒÆ’Ã¢â€šÂ¬ÃƒÆ’Ã‚ÂÃƒÆ’Ã¢â‚¬Å¡ÃƒÆ’Ã†â€™ÃƒÆ’Ã¢â‚¬Å¾ÃƒÆ’Ã¢â‚¬Â¦ÃƒÆ’Ã¢â‚¬ ÃƒÆ’Ã¢â‚¬Â¡ÃƒÆ’Ã‹â€ ÃƒÆ’Ã¢â‚¬Â°ÃƒÆ’Ã… ÃƒÆ’Ã¢â‚¬Â¹ÃƒÆ’Ã…â€™ÃƒÆ’Ã‚ÂÃƒÆ’Ã…Â½ÃƒÆ’Ã‚ÂÃƒÆ’Ã‚ÂÃƒÆ’Ã¢â‚¬ËœÃƒÆ’Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Å“ÃƒÆ’Ã¢â‚¬ÂÃƒÆ’Ã¢â‚¬Â¢ÃƒÆ’Ã¢â‚¬â€œÃƒÆ’Ã‹Å“ÃƒÆ’Ã¢â€žÂ¢ÃƒÆ’Ã…Â¡ÃƒÆ’Ã¢â‚¬ÂºÃƒÆ’Ã…â€œÃƒÆ’Ã‚ÂÃƒâ€¦Ã¢â‚¬ÂÃƒÆ’Ã…Â¾ÃƒÆ’Ã…Â¸ÃƒÆ’ ÃƒÆ’Ã‚Â¡ÃƒÆ’Ã‚Â¢ÃƒÆ’Ã‚Â£ÃƒÆ’Ã‚Â¤ÃƒÆ’Ã‚Â¥ÃƒÆ’Ã‚Â¦ÃƒÆ’Ã‚Â§ÃƒÆ’Ã‚Â¨ÃƒÆ’Ã‚Â©ÃƒÆ’Ã‚ÂªÃƒÆ’Ã‚Â«ÃƒÆ’Ã‚Â¬ÃƒÆ’Ã‚Â­ÃƒÆ’Ã‚Â®ÃƒÆ’Ã‚Â¯ÃƒÆ’Ã‚Â°ÃƒÆ’Ã‚Â±ÃƒÆ’Ã‚Â²ÃƒÆ’Ã‚Â³ÃƒÆ’Ã‚Â´ÃƒÆ’Ã‚ÂµÃƒÆ’Ã‚Â¶ÃƒÆ’Ã‚Â¸ÃƒÆ’Ã‚Â¹ÃƒÆ’Ã‚ÂºÃƒÆ’Ã‚Â»ÃƒÆ’Ã‚Â¼ÃƒÆ’Ã‚Â½ÃƒÆ’Ã‚Â¾ÃƒÆ’Ã‚Â¿Ãƒâ€¦Ã¢â‚¬Â¢";
                sem_acento = "AAAAAAACEEEEIIIIDNOOOOOOUUUUYRsBaaaaaaaceeeeiiiionoooooouuuuybyr";
                novastr = "";
                for (i = 0; i < str.length; i++) {
                    troca = false;
                    for (a = 0; a < com_acento.length; a++) {
                        if (str.substr(i, 1) == com_acento.substr(a, 1)) {
                            novastr += sem_acento.substr(a, 1);
                            troca = true;
                            break;
                        }
                    }
                    if (troca == false) {
                        novastr += str.substr(i, 1);
                    }
                }
                return novastr;
            },
            //REQUISIÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¡ÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢O DAS INFORMAÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¡ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¢ES DO JSON
            //MONTAGEM DE ESTRUTURAS
            collecttionConstructor: (colecaoJson) => {
                // try {
                //     colecao = $('h5.Colecao+ul.Filtros li.filtro-ativo')[0].innerText;
                // } catch (error) {
                //     colecao = '';
                //     console.log('error get colecao collecttionConstructor function');
                //     console.log(error.message);
                // }

                if (!$('h5.Colecao+ul.Filtros li.filtro-ativo').length) {
                    return;
                }
                colecao = $('h5.Colecao+ul.Filtros li.filtro-ativo')[0].innerText;
                try {
                    bannerTop = colecaoJson[colecao]['bannerTop'];
                    bannersBottom = colecaoJson[colecao]['bannersBottom'];
                    desc = colecaoJson[colecao]['desc'];
                    video = colecaoJson[colecao]['video'];
                } catch (error) {
                    console.log(error)
                }
        
                var colecao_class = NewSearch.retira_acentos(colecao.toLowerCase().replaceAll(' ', '-'))
        
                var ColecaoTop = '<div class="ColecaoTop ct-' + colecao_class + '"></div>';
                var ColecaoBottom = '<div class="ColecaoBottom cb-' + colecao_class + '"><h2 class="ColecaoTitulo ctl-' + colecao_class + '">' + colecao + '</h2></div>';
        
                if (colecao.length > 0) {
        
                    $('#main').prepend(ColecaoTop);
                    if (bannersBottom != undefined || video != undefined || desc != undefined) {
                        $('#main').append(ColecaoBottom);
                    }
                }
                try {
                    //LOOP PARA COLOCAR 1 OU + IMAGENS 
                    if (bannersBottom != undefined) {
                        ColecaoBannersBottom = '';
                        for (i = 0; bannersBottom.length > i; i++) {
                            ColecaoBannersBottom += '<div class="ColecaoBannerBottom cbb-' + colecao_class + '" style=" width:' + (100 / bannersBottom.length) + '%;"><img src="' + bannersBottom[i] + '"></div>';
                        }
                        $('.ColecaoBottom').append(ColecaoBannersBottom);
                    }
        
                    //CONDIÃƒÆ’Ã¢â‚¬Â¡ÃƒÆ’Ã¢â‚¬Â¢ES PARA EXISTENCIA E MONTAGEM DAS ESTRUTURAS HTML
                    if (video != undefined) {
                        ColecaoVideo = '<iframe class="ColecaoVideo cv-' + colecao_class + '" width="90%" height="315" src="' + video + '" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" allowtransparency="true"></iframe>';
                        $('.ColecaoBottom').append(ColecaoVideo);
                    }
                    if (bannerTop != undefined) {
                        ColecaoBannerTop = '<img class="ColecaoBannerTop cbt-' + colecao_class + '" src="' + bannerTop + '"></img>'
                        $('.ColecaoTop').prepend(ColecaoBannerTop);
                    }
                    if (desc != undefined) {
                        ColecaoDescTop = '<span class="ColecaoDescTop cdt-' + colecao_class + '">' + desc + '</span>';
                        /*FIX COLEÃƒÆ’Ã¢â‚¬Â¡ÃƒÆ’Ã†â€™O LEOPARDO START*/
                        if (document.URL.includes('/joias/Leopardo')) {
                            $('#bar-fixed-nav').after('<div class="ColecaoBottom cb-' + colecao_class + '">' + ColecaoDescTop + '</div>');
                            if ($(window).width() <= 768) {
                                $('.prateleira .vitrine ul').css('width', '100%');
                            }
                        } else {
                            $('.ColecaoBottom').append(ColecaoDescTop);
                        }
        
        
                    }
                } catch (e) {
                    console.log('error bannersbottom structureCollecttionConstructor function');
                }
            },
            wineryConstructor: (vinicolasJson) => {
                try {
                    var vinicola = $('h5.Vinicola+ul.EspecificaÃƒÆ’Ã‚Â§ÃƒÆ’Ã‚Âµes li.filtro-ativo')[0].innerText;
                    var bannerTop = vinicolasJson[vinicola]['bannerTop'];
        
                } catch (error) {
                    vinicola = ''
                    console.log('error get vinicola wineryConstructor function');
                }
        
                if (vinicola.length > 0) {
                    var ColecaoTop = '<div class="ColecaoTop"></div>';
                    $('#main').prepend(ColecaoTop);
                    //CONDIÃƒÆ’Ã¢â‚¬Â¡ÃƒÆ’Ã¢â‚¬Â¢ES PARA EXISTENCIA E MONTAGEM DAS ESTRUTURAS HTML
                    if (bannerTop != undefined) {
                        ColecaoBannerTop = '<img class="ColecaoBannerTop" src="' + bannerTop + '"></img>'
                        $('.ColecaoTop').prepend(ColecaoBannerTop);
                    }
                }
        
            },
            adegaMiniBannerConstructor: (ctgAdega) => {
                var ctgData = ctgAdega[0]
                var category = vtxctx["categoryName"]
                var pathname = '';
                try {
                    pathname = ctgData[category]['pathname'];
                    pTxt = ctgData[category]['principalTxt'];
                    banner = ctgData[category]['banners'];
                    text = ctgData[category]['texts'];
                    link = ctgData[category]['links'];
                } catch (e) {
                    console.log("error on get ctgAdega content");
                }
        
        
                if (window.location.pathname == pathname) {
                    $('.breadcrumbJV').hide()
                    structure =
                        '<div class="banners-navigation nav-' + category + '">' +
                        '<h2 class="bn-pTxt">' + pTxt + '</h2>' +
                        '<ul></ul> ' +
                        '</div>';
                    $('#bar-fixed-nav').after(structure)
                    for (i = 1; i <= 3; i++) {
                        structureItems =
                            '<li class="navBn-' + i + '">' +
                            '<a href="' + link['link-' + i] + '">' +
                            '<span class="textBanner bnr-' + i + '">' + text['text-' + i] + '</span>' +
                            '<img src="' + banner['banner-' + i] + '">' +
                            '<span class="bnDiscount dct-' + i + '">5% OFF</span>' +
                            '</a>' +
                            '</li>';
                        $('.banners-navigation ul').append(structureItems)
                    }
        
                    if (pathname != "/adega/vinhos") {
                        $('.bnDiscount').hide();
                    }
                }
            },
            // other
            otherFunctions: () => {
                $.getJSON("https://jackvartanian.vteximg.com.br/arquivos/000-JML-jsonColecoes.js", function(colecaoJson) {
                    NewSearch.collecttionConstructor(colecaoJson);
                });

                if (window.location.href.includes('brand=true')) {
                    $.getJSON("https://jackvartanian.vteximg.com.br/arquivos/000-JML-jsonVinicolas.js", function(vinicolasJson) {
                        NewSearch.wineryConstructor(vinicolasJson);
                    });
                    $('.ColecaoDescTop').hide();
                    $('.ColecaoTitulo').hide();
                } else {
                    $('.adegaBannerPrincipal').css('display', 'flex');
                }

                $('.adegaBannerPrincipal1').slick({
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    autoplay: true,
                    autoplaySpeed: 3000,
                });

                if (document.URL.includes('de-1-a-3000')) {
                    document.getElementsByTagName("title")[0].innerText = 'Joias atÃƒÆ’Ã‚Â© R$3.000,00 - Jack Vartanian';
                }
            },
            applyPromotionWeekCustomer: () => {
                if (document.URL.includes('lpsale=true')) {
                    $('.placements-vitrines-imgs').before('<img src="/arquivos/banner-lp-salejun2021.jpg" style="width: 100%;"></img>')
                }
                try {
                    if (!$('ul li.filtro-ativo').length) {
                        return;
                    }
                    if ($('ul li.filtro-ativo').text() == 'Semana do consumidor') {
                        $('.placements-vitrines-imgs').before('<img src="/arquivos/banner-pag-semanaconsumidor.jpg" style="width: 100%;"></img>')
                        if ($('.filtro-ativo').length) {
                            if ($('.filtro-ativo')[1] == undefined) {
                                if (!document.URL.includes('Masculino')) {
                                    if (!document.URL.includes('Feminino')) {
                                        if (vtxctx.categoryName == "Joias") {
                                            $('.placements-vitrines-imgs').append(`<vtex:contentPlaceHolder id="natal33" />`);
                                            document.title = 'Semana do Consumidor | Jack Vartanian';
                                        }
                                    }
                                }
                            }
                        }
                    }
        
        
                    if (document.URL.includes('/379?')) {
                        if ($('.filtro-ativo')[0] != undefined) {
                            if ($('.filtro-ativo')[1] == undefined) {
                                if (!document.URL.includes('Masculino')) {
                                    if (!document.URL.includes('Feminino')) {
                                        if (vtxctx.categoryName == "Joias") {
                                            document.title = 'Semana do Consumidor | Jack Vartanian';
                                        }
                                    }
                                }
                            }
                        }
                    }
        
                } catch (e) {
                    console.log("Error in [applyPromotionWeekCustomer]");
                    console.log(e.message);
                }
            }
        };

        // Instanciando a funcao
        $(document).ready(NewSearch.init);
        let windowLoad = function () {
            NewSearch.windowOnload();
        };
        $(window).load(windowLoad);
        $(document).ajaxStop(NewSearch.ajaxStop);

    } catch (e) {
        console.log("Erro na instância do [NewSearch]: ", e);
    }

})();